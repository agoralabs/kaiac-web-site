<div class="card">
    <div class="card-body">
        <h1>Solution ALFRESCO</h1>
        <h5 class="card-subtitle text-muted">The Auto Scaling Group KvBook allow you to create an Auto Scaling group behind an exisiting ALB with EC2 instances with KaiaC.</h5>

        <h2>Design</h2>
        <pre>This is what you can create with an Auto Scaling Group KvBook</pre>
        <pre>
        <img
        src="assets/images/galery/solutions/solutions-ALFRESCO.png"
        alt="solutions-ALFRESCO"
        width="80%"/>
        </pre>

        <h2>Key/Value parameters</h2>
        <div class="table-responsive">
            <table class="table table-hover align-middle text-nowrap table-bordered table-striped">
                <thead>
                    <tr>
                        <th class="text-dark font-medium fs-4">#</th>
                        <th class="text-dark font-medium fs-4">Name</th>
                        <th class="text-dark font-medium fs-4">Example value</th>
                        <th class="text-dark font-medium fs-4">Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>GL_AWS_REGION</td>
                        <td>us-west-2</td>
                        <td>The AWS region your resources will be deployed</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>GL_AWS_CRED_FILE_PATH</td>
                        <td>~/.aws/credentials</td>
                        <td>The AWS credentials file path</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>GL_AWS_CRED_PROFILE</td>
                        <td>default</td>
                        <td>The AWS credentials profile</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>GL_KAIAC_MODULE</td>
                        <td>asgroup</td>
                        <td>The name of kaiac module to run</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>GL_NAMESPACE</td>
                        <td>vmgrpub001</td>
                        <td>The application global resources namespace</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>GL_NAME</td>
                        <td>demo1</td>
                        <td>The application name</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>GL_STAGE</td>
                        <td>staging</td>
                        <td>The application stage name</td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>GL_AWS_AZS</td>
                        <td>us-west-2a,us-west-2b</td>
                        <td>The AWS azs your resources will be deployed</td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>GL_AWS_ROUTE53_DOMAIN</td>
                        <td>skyscaledev.com</td>
                        <td>The Route53 Domain name</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>GL_DNS_RECORD_TTL</td>
                        <td>300</td>
                        <td>The DNS record TTL</td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td>GL_VPC_FILTER_NAME</td>
                        <td>tag:Name</td>
                        <td>The VPC filter name</td>
                    </tr>
                    <tr>
                        <td>12</td>
                        <td>GL_VPC_FILTER_VALUE</td>
                        <td>vpc001-demo1-staging-vpc</td>
                        <td>The VPC Name</td>
                    </tr>
                    <tr>
                        <td>13</td>
                        <td>GL_VPC_SUBNET_FILTER_NAME</td>
                        <td>tag:Name</td>
                        <td>The Public Subnet filter name subnet-id or tag:Name</td>
                    </tr>
                    <tr>
                        <td>14</td>
                        <td>GL_VPC_SUBNET_FILTER_VALUE1</td>
                        <td>vpc001-demo1-staging-public-subnet1</td>
                        <td>The Public Subnet1 filter value eg subnet name</td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td>GL_VPC_SUBNET_FILTER_VALUE2</td>
                        <td>vpc001-demo1-staging-public-subnet2</td>
                        <td>The Public Subnet2 filter value eg subnet name</td>
                    </tr>
                    <tr>
                        <td>16</td>
                        <td>GL_VPC_SUBNET_PRV_FILTER_VALUE1</td>
                        <td>vpc001-demo1-staging-private-subnet1</td>
                        <td>The Private Subnet1 filter value eg subnet name</td>
                    </tr>
                    <tr>
                        <td>17</td>
                        <td>GL_VPC_SUBNET_PRV_FILTER_VALUE2</td>
                        <td>vpc001-demo1-staging-private-subnet2</td>
                        <td>The Private Subnet2 filter value eg subnet name</td>
                    </tr>
                    <tr>
                        <td>18</td>
                        <td>GL_VPC_SUBNET_PRV_FILTER_VALUE2</td>
                        <td>vpc001-demo1-staging-private-subnet2</td>
                        <td>The Private Subnet2 filter value eg subnet name</td>
                    </tr>
                    <tr>
                        <td>19</td>
                        <td>GL_VPC_USE_PRIVATE_SUBNETS</td>
                        <td>true</td>
                        <td>The flag to use private subnets if true else public subnets</td>
                    </tr>
                    <tr>
                        <td>20</td>
                        <td>BE_PATH_EC2_PUBKEY</td>
                        <td>~/.ssh/id_rsa.pub</td>
                        <td>The ec2 instance public key path</td>
                    </tr>
                    <tr>
                        <td>21</td>
                        <td>BE_EC2_TYPE</td>
                        <td>t2.micro</td>
                        <td>The EC2 instance type</td>
                    </tr>
                    <tr>
                        <td>22</td>
                        <td>BE_ASG_DESIRED_CAPACITY</td>
                        <td>2</td>
                        <td>The Autoscalling desired capacity</td>
                    </tr>
                    <tr>
                        <td>23</td>
                        <td>BE_ASG_MIN_SIZE</td>
                        <td>1</td>
                        <td>The Autoscalling min size</td>
                    </tr>
                    <tr>
                        <td>23</td>
                        <td>BE_ASG_MAX_SIZE</td>
                        <td>4</td>
                        <td>The Autoscalling max size</td>
                    </tr>
                    <tr>
                        <td>24</td>
                        <td>BE_EC2_VOLUME_SIZE</td>
                        <td>20</td>
                        <td>The EC2 instance root volume size en giga</td>
                    </tr>
                    <tr>
                        <td>25</td>
                        <td>BE_LOCAL_PORT</td>
                        <td>8080</td>
                        <td>The EC2 instance local port</td>
                    </tr>
                    <tr>
                        <td>26</td>
                        <td>BE_AMI_NAME</td>
                        <td>ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-20230919</td>
                        <td>The ec2 instance Amazon AMI name</td>
                    </tr>
                    <tr>
                        <td>27</td>
                        <td>BE_CREATE_DNS</td>
                        <td>true</td>
                        <td>The flag to create or not a Route 53 DNS record</td>
                    </tr>
                    <tr>
                        <td>28</td>
                        <td>BE_DNS</td>
                        <td>asgroup001-demo1-staging</td>
                        <td>The ec2 instance domain name</td>
                    </tr>
                    <tr>
                        <td>29</td>
                        <td>BE_DOMAIN_NAME</td>
                        <td>asgroup001-demo1-staging.skyscaledev.com</td>
                        <td>The private subnet1 cidr block</td>
                    </tr>
                    <tr>
                        <td>30</td>
                        <td>BE_EXISTING_ALB_NAME</td>
                        <td>alb001-demo1-staging-lb</td>
                        <td>Existing ALB name to use</td>
                    </tr>
                    <tr>
                        <td>31</td>
                        <td>BE_EXISTING_LISTENER_443</td>
                        <td>false</td>
                        <td>Existing listener to use or create if false</td>
                    </tr>
                    <tr>
                        <td>32</td>
                        <td>BE_ADD_SNI_CERT</td>
                        <td>true</td>
                        <td>Flag to add or not an sni certificate to ALB</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2>Results</h2>
        <pre>Go to your AWS EC2 Service console.</pre>
        <pre>Your Auto Scaling group and EC2 instances should be created</pre>

        <h2>Try</h2>
        <pre>You can use this KvBook to try to create an Auto Scaling group with KaiaC :</pre>
        <pre>

GL_AWS_REGION="us-west-2"
GL_AWS_CRED_FILE_PATH="~/.aws/credentials"
GL_AWS_CRED_PROFILE="default"
GL_KAIAC_MODULE="asgroup"
GL_NAMESPACE="asgroup001"
GL_NAME="demo1"
GL_STAGE="staging"
GL_AWS_AZS="us-west-2a,us-west-2b"
GL_AWS_ROUTE53_DOMAIN="skyscaledev.com"
GL_DNS_RECORD_TTL="300"
GL_VPC_FILTER_NAME="tag:Name"
GL_VPC_FILTER_VALUE="vpc001-demo1-staging-vpc"
GL_VPC_SUBNET_FILTER_NAME="tag:Name"
GL_VPC_SUBNET_FILTER_VALUE1="vpc001-demo1-staging-public-subnet1"
GL_VPC_SUBNET_FILTER_VALUE2="vpc001-demo1-staging-public-subnet2"
GL_VPC_SUBNET_PRV_FILTER_VALUE1="vpc001-demo1-staging-private-subnet1"
GL_VPC_SUBNET_PRV_FILTER_VALUE2="vpc001-demo1-staging-private-subnet2"
GL_VPC_USE_PRIVATE_SUBNETS="true"
BE_PATH_EC2_PUBKEY="/root/profiles/asgroup001/ssh/SSHPUBKEY"
BE_EC2_TYPE="t2.micro"
BE_ASG_DESIRED_CAPACITY="1"
BE_ASG_MIN_SIZE="1"
BE_ASG_MAX_SIZE="4"
BE_EC2_VOLUME_SIZE="20"
BE_LOCAL_PORT="8080"
BE_AMI_NAME="ubuntu-laravel-ami-docker"
BE_CREATE_DNS="true"
BE_DNS="asgroup001-demo1-staging"
BE_DOMAIN_NAME="asgroup001-demo1-staging.skyscaledev.com"
BE_EXISTING_ALB_NAME="alb001-demo1-staging-lb"
BE_EXISTING_LISTENER_443="false"
BE_ADD_SNI_CERT="true"
            
        </pre>

        <a href="/roadmap" class="btn btn-primary">Take a look at KaiaC Roadmap</a>
    </div>
</div>


